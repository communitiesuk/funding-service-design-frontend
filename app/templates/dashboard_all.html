{%- from "govuk_frontend_jinja/components/tag/macro.html" import govukTag -%}
{%- from "govuk_frontend_jinja/components/table/macro.html" import govukTable -%}
{%- from "govuk_frontend_jinja/components/button/macro.html" import govukButton -%}
{% from "partials/start-application-button.html" import startApplicationButton %}
{% from "partials/available_in_language.html" import available_in_language %}
{% from "partials/round_closed_warning.html" import round_closed_warning %}
{% from "partials/applications_table.html" import applications_table %}

{% extends "base.html" %}
{% set pageHeading %}
{% trans %}All applications{% endtrans %}
{% endset %}
{% block content %}
    <h1 class="govuk-heading-xl">{{ pageHeading }}</h1>
    {% if display_data["total_applications_to_display"] == 0 %}
        <p class="govuk-body">
            {% trans %}You have not started any applications using this email address{% endtrans %}.
        </p>
    {% endif %}
{{available_in_language(inset=False, warn=True, welsh_available=welsh_available)}}

<div class="govuk-accordion" data-module="govuk-accordion" id="accordion-default">
    {% for fund in display_data["funds"] %}
        <div class="govuk-accordion__section">
            <div class="govuk-accordion__section-header">
                <h2 class="govuk-accordion__section-heading">
                    <span class="govuk-accordion__section-button" id="funds-heading-{{fund['fund_data']['short_name']}}">
                        {{ fund["fund_data"]["name"] }}
                    </span>
                </h2>
            </div>
            <div id="funds-content-{{fund['fund_data']['short_name']}}" class="govuk-accordion__section-content" aria-labelledby="funds-heading-{{fund['fund_data']['short_name']}}">

                {% for round in fund["rounds"] %}
                    {% if not round["is_not_yet_open"] %}
                        {% if  not round["is_past_submission_deadline"] %}
                            <span class="govuk-caption-m">{{ round["round_details"]["title"] }}</span>
                            {{ applications_table(round["applications"], round["is_past_submission_deadline"], show_language_column) }}
                        {% endif %}
                    {% endif %}
                {% endfor %}

                {% if fund["rounds"] | length > 0 %}
                    <p class="govuk-body">
                        <a href="{{url_for('account_routes.dashboard', fund=fund['fund_data']['short_name'])}}" class="govuk-link govuk-link">
                            View applications from all rounds/windows
                        </a>
                    </p>
                {% endif %}
            </div>
        </div>

    {% endfor %}
</div>
{% endblock %}
